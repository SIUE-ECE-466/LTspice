Version 4
SHEET 1 3944 2244
WIRE 2704 800 2688 800
WIRE 2800 800 2768 800
WIRE 2880 800 2864 800
WIRE 2560 880 2464 880
WIRE 2688 880 2688 800
WIRE 2880 880 2880 800
WIRE 2880 880 2768 880
WIRE 1120 896 1056 896
WIRE 2880 960 2880 880
WIRE 2880 960 2864 960
WIRE 2912 960 2880 960
WIRE 3024 960 2992 960
WIRE 2560 976 2560 880
WIRE 2560 976 2528 976
WIRE 2592 976 2560 976
WIRE 2688 976 2688 880
WIRE 2688 976 2672 976
WIRE 2800 976 2688 976
WIRE 1120 992 1120 896
WIRE 1120 992 1088 992
WIRE 1168 992 1120 992
WIRE 1280 992 1232 992
WIRE 2368 992 2336 992
WIRE 2384 992 2384 880
WIRE 2384 992 2368 992
WIRE 2464 992 2384 992
WIRE 2880 992 2864 992
WIRE 976 1008 976 896
WIRE 976 1008 832 1008
WIRE 1024 1008 976 1008
WIRE 2272 1008 2192 1008
WIRE 2560 1008 2528 1008
WIRE 1120 1024 1088 1024
WIRE 2368 1024 2336 1024
WIRE 2384 1024 2368 1024
WIRE 2880 1024 2880 992
WIRE 1120 1056 1120 1024
WIRE 1280 1056 1280 992
WIRE 2384 1056 2384 1024
WIRE 2560 1056 2560 1008
WIRE 1408 1104 1376 1104
WIRE 1536 1104 1488 1104
WIRE 624 1120 576 1120
WIRE 736 1120 704 1120
WIRE 1040 1120 976 1120
WIRE 1136 1120 1104 1120
WIRE 1536 1216 1536 1104
WIRE 1536 1216 1488 1216
WIRE 1568 1216 1536 1216
WIRE 1920 1216 1648 1216
WIRE 1136 1232 1136 1120
WIRE 1136 1232 1104 1232
WIRE 1168 1232 1136 1232
WIRE 1280 1232 1280 1136
WIRE 1280 1232 1248 1232
WIRE 1376 1232 1376 1104
WIRE 1376 1232 1280 1232
WIRE 1424 1232 1376 1232
WIRE 736 1248 736 1120
WIRE 736 1248 704 1248
WIRE 752 1248 752 1008
WIRE 752 1248 736 1248
WIRE 768 1248 752 1248
WIRE 976 1248 976 1120
WIRE 976 1248 848 1248
WIRE 1040 1248 976 1248
WIRE 1536 1248 1488 1248
WIRE 576 1264 576 1120
WIRE 576 1264 496 1264
WIRE 640 1264 576 1264
WIRE 1152 1264 1104 1264
WIRE 720 1280 704 1280
WIRE 1152 1296 1152 1264
WIRE 1920 1296 1920 1216
WIRE 2640 1296 2320 1296
WIRE 1536 1312 1536 1248
WIRE 1568 1312 1536 1312
WIRE 1712 1312 1648 1312
WIRE 720 1328 720 1280
WIRE 2320 1328 2320 1296
WIRE 2640 1328 2640 1296
WIRE 1536 1360 1536 1312
WIRE 1712 1408 1712 1312
WIRE 2592 1408 2560 1408
WIRE 2560 1424 2560 1408
WIRE 1040 1440 1008 1440
WIRE 1168 1440 1120 1440
WIRE 2320 1456 2320 1408
WIRE 2640 1472 2640 1424
WIRE 2768 1472 2640 1472
WIRE 2944 1472 2848 1472
WIRE 3008 1472 2944 1472
WIRE 1536 1520 1536 1440
WIRE 2560 1520 2560 1504
WIRE 2640 1520 2640 1472
WIRE 2640 1520 2560 1520
WIRE 2944 1520 2944 1472
WIRE 1712 1536 1712 1488
WIRE 1168 1552 1168 1440
WIRE 1168 1552 1120 1552
WIRE 1184 1552 1168 1552
WIRE 1280 1552 1280 1232
WIRE 1280 1552 1264 1552
WIRE 752 1568 752 1248
WIRE 784 1568 752 1568
WIRE 1008 1568 1008 1440
WIRE 1008 1568 864 1568
WIRE 1056 1568 1008 1568
WIRE 2640 1568 2640 1520
WIRE 1152 1584 1120 1584
WIRE 2944 1600 2944 1584
WIRE 1152 1632 1152 1584
WIRE 2592 1648 2560 1648
WIRE 2560 1664 2560 1648
WIRE 2640 1696 2640 1664
WIRE 2608 1904 2576 1904
WIRE 2704 1904 2688 1904
WIRE 2784 1904 2752 1904
WIRE 2896 1904 2864 1904
WIRE 2224 1968 2224 1952
WIRE 2320 1968 2224 1968
WIRE 2224 1984 2224 1968
WIRE 2464 1984 2432 1984
WIRE 2576 1984 2576 1904
WIRE 2576 1984 2544 1984
WIRE 2704 1984 2704 1904
WIRE 2752 1984 2752 1904
WIRE 2752 1984 2704 1984
WIRE 2896 1984 2896 1904
WIRE 2992 1984 2896 1984
WIRE 2320 2000 2320 1968
WIRE 2992 2016 2992 1984
WIRE 2576 2048 2576 1984
WIRE 2608 2048 2576 2048
WIRE 2704 2048 2704 1984
WIRE 2704 2048 2672 2048
WIRE 2752 2048 2752 1984
WIRE 2784 2048 2752 2048
WIRE 2896 2048 2896 1984
WIRE 2896 2048 2848 2048
WIRE 2992 2128 2992 2096
FLAG 2560 1744 0
FLAG 2640 1696 0
FLAG 2320 1456 0
FLAG 2944 1600 0
FLAG 2384 1136 0
FLAG 2992 2128 0
FLAG 2880 1024 0
FLAG 2304 976 VN
FLAG 2496 1024 VN
FLAG 2304 1040 VP
FLAG 2496 960 VP
FLAG 2832 1008 VN
FLAG 2832 944 VP
FLAG 3024 960 CO
FLAG 2192 1008 D
FLAG 2320 2000 0
FLAG 2224 1872 VP
FLAG 2224 2064 VN
FLAG 1120 1056 0
FLAG 1152 1296 0
FLAG 1152 1632 0
FLAG 1920 1376 0
FLAG 1712 1536 0
FLAG 1536 1520 0
FLAG 496 1264 CO
FLAG 1088 1600 VN
FLAG 1072 1280 VN
FLAG 1056 1040 VN
FLAG 1456 1264 VN
FLAG 1072 1216 VP
FLAG 1456 1200 VP
FLAG 1056 976 VP
FLAG 1088 1536 VP
FLAG 672 1232 VP
FLAG 672 1296 VN
FLAG 2640 1472 X
FLAG 2320 1296 IN
FLAG 2560 1056 0
FLAG 2368 1024 TR
FLAG 2368 992 LM
FLAG 720 1328 0
FLAG 3008 1472 O
FLAG 2432 1984 O
SYMBOL voltage 2320 1312 M0
WINDOW 3 39 45 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 38 72 Left 2
WINDOW 0 37 16 Left 2
SYMATTR Value 12V
SYMATTR SpiceLine Rser=0
SYMATTR InstName V1
SYMBOL ind 2752 1488 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 5µ
SYMBOL cap 2928 1520 R0
SYMATTR InstName C1
SYMATTR Value 2.1µ
SYMBOL OpAmps\\LT1216 2304 1072 R180
SYMATTR InstName U1
SYMBOL OpAmps\\OP27 2496 928 M0
SYMATTR InstName U2
SYMBOL res 2480 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL voltage 2384 1040 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value PULSE(-5 5 0 2.5u 2.5u 0 5u)
SYMBOL res 2688 960 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL OpAmps\\OP27 2832 912 M0
SYMATTR InstName U3
SYMBOL res 3008 944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 2784 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL diode 2768 784 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMATTR Value Zen3V7
SYMBOL diode 2800 784 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D2
SYMATTR Value Zen3V7
SYMBOL voltage 2992 2000 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 3.7V
SYMBOL voltage 2224 1856 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V6
SYMATTR Value 15V
SYMBOL voltage 2224 1968 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value 15V
SYMBOL OpAmps\\OP27 672 1200 M0
SYMATTR InstName U4
SYMBOL OpAmps\\OP27 1056 944 M0
SYMATTR InstName U5
SYMBOL OpAmps\\OP27 1456 1168 M0
SYMATTR InstName U8
SYMBOL res 864 1232 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 720 1104 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 880 1552 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL res 1136 1424 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 20k
SYMBOL res 848 992 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 10k
SYMBOL res 1072 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL cap 1104 1104 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1n
SYMBOL res 1264 1216 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res 1280 1536 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL cap 1232 976 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 100p
SYMBOL res 1264 1040 R0
SYMATTR InstName R14
SYMATTR Value 50
SYMBOL res 1504 1088 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 1664 1200 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res 1664 1296 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL voltage 1712 1392 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value PULSE(-3 3 1m 10n 10n 1 1m)
SYMBOL res 1520 1344 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL OpAmps\\LT1001 1072 1184 M0
SYMATTR InstName U6
SYMBOL OpAmps\\LT1001 1088 1504 M0
SYMATTR InstName U7
SYMBOL nmos 2592 1328 R0
SYMATTR InstName M3
SYMATTR Value SIMP
SYMBOL nmos 2592 1568 R0
SYMATTR InstName M4
SYMATTR Value SIMP
SYMBOL bv 2560 1408 M0
SYMATTR InstName B1
SYMATTR Value V=v(D)
SYMBOL bv 2560 1648 M0
SYMATTR InstName B2
SYMATTR Value V=-v(D)
SYMBOL bv 1920 1280 R0
SYMATTR InstName B3
SYMATTR Value V=i(R5)/10
SYMBOL res 2448 2000 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 1m
SYMBOL res 2592 1920 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R19
SYMATTR Value 0.1m
SYMBOL res 2768 1920 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 0.1m
SYMBOL cap 2608 2064 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C4
SYMATTR Value 15
SYMBOL cap 2784 2064 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value 1.5
TEXT 2568 1816 Left 2 ;3.7V Lithium-Ion Battery Cell
TEXT 2528 704 Left 2 ;Compensator
TEXT 1152 704 Left 2 ;Analog PID Controller
TEXT 1184 1816 Left 2 ;Spice Directives
TEXT 480 1872 Left 2 !.ic v(C1)=0\n.ic v(C2)=0\n.ic v(C3)=0\n.ic v(C4)=0\n.ic v(C5)=0\n.ic v(O)=3.7\n.ic i(L1)=0\n.tran 0 20m 0.5m\n.model SIMP vdmos(VTO=3 KP=90)\n.model Zen3V7 D(Is=1.5n Rs=.5 Cjo=185p nbv=3 bv=3.7 ibv=1m Vpk=3.7)
LINE Normal 3088 1840 2400 1840
LINE Normal 3088 1840 3088 1840 2
LINE Normal 2112 736 448 736
LINE Normal 3088 736 2112 736
LINE Normal 448 1792 2400 1792
LINE Normal 2112 1792 2112 1248
LINE Normal 2112 1840 448 1840
RECTANGLE Normal 3088 2160 2400 1792
RECTANGLE Normal 2112 2160 448 1792
RECTANGLE Normal 3088 672 2112 1248
RECTANGLE Normal 448 672 3088 2160
